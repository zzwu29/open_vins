\hypertarget{classov__core_1_1FeatureDatabase}{}\section{ov\+\_\+core\+:\+:Feature\+Database Class Reference}
\label{classov__core_1_1FeatureDatabase}\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}


Database containing features we are currently tracking.  




{\ttfamily \#include $<$Feature\+Database.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a26d81dfa410ec463172796cc9ae8cafd}\label{classov__core_1_1FeatureDatabase_a26d81dfa410ec463172796cc9ae8cafd}} 
\hyperlink{classov__core_1_1FeatureDatabase_a26d81dfa410ec463172796cc9ae8cafd}{Feature\+Database} ()
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ \hyperlink{classov__core_1_1FeatureDatabase_a3c7b5ef425c785eb3c160e995c545f87}{get\+\_\+feature} (size\+\_\+t id, bool remove=false)
\begin{DoxyCompactList}\small\item\em Get a specified feature. \end{DoxyCompactList}\item 
bool \hyperlink{classov__core_1_1FeatureDatabase_a98e2d5320881107343b07f79cac8b541}{get\+\_\+feature\+\_\+clone} (size\+\_\+t id, \hyperlink{classov__core_1_1Feature}{Feature} \&feat)
\begin{DoxyCompactList}\small\item\em Get a specified feature clone (pointer is thread safe) \end{DoxyCompactList}\item 
void \hyperlink{classov__core_1_1FeatureDatabase_adf78008573a5aebe8a89cddbaf4b5b01}{update\+\_\+feature} (size\+\_\+t id, double timestamp, size\+\_\+t cam\+\_\+id, float u, float v, float u\+\_\+n, float v\+\_\+n)
\begin{DoxyCompactList}\small\item\em Update a feature object. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ \hyperlink{classov__core_1_1FeatureDatabase_a4f6d8da846e81eac1faa3c7abd7f44a7}{features\+\_\+not\+\_\+containing\+\_\+newer} (double timestamp, bool remove=false, bool skip\+\_\+deleted=false)
\begin{DoxyCompactList}\small\item\em Get features that do not have newer measurement then the specified time. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ \hyperlink{classov__core_1_1FeatureDatabase_a5cdb62171c42c8787daec984a8cebe15}{features\+\_\+containing\+\_\+older} (double timestamp, bool remove=false, bool skip\+\_\+deleted=false)
\begin{DoxyCompactList}\small\item\em Get features that has measurements older then the specified time. \end{DoxyCompactList}\item 
std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ \hyperlink{classov__core_1_1FeatureDatabase_a144b59272688f0aeea0ecec6028dca04}{features\+\_\+containing} (double timestamp, bool remove=false, bool skip\+\_\+deleted=false)
\begin{DoxyCompactList}\small\item\em Get features that has measurements at the specified time. \end{DoxyCompactList}\item 
void \hyperlink{classov__core_1_1FeatureDatabase_abee9d8a5fa7fc4a97911058b6e8d10a0}{cleanup} ()
\begin{DoxyCompactList}\small\item\em This function will delete all features that have been used up. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a690e2279ff954a380036f6e69445fa16}\label{classov__core_1_1FeatureDatabase_a690e2279ff954a380036f6e69445fa16}} 
void \hyperlink{classov__core_1_1FeatureDatabase_a690e2279ff954a380036f6e69445fa16}{cleanup\+\_\+measurements} (double timestamp)
\begin{DoxyCompactList}\small\item\em This function will delete all feature measurements that are older then the specified timestamp. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a08484576099480a2fd0b0cc9630c12b6}\label{classov__core_1_1FeatureDatabase_a08484576099480a2fd0b0cc9630c12b6}} 
void \hyperlink{classov__core_1_1FeatureDatabase_a08484576099480a2fd0b0cc9630c12b6}{cleanup\+\_\+measurements\+\_\+exact} (double timestamp)
\begin{DoxyCompactList}\small\item\em This function will delete all feature measurements that are at the specified timestamp. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_ab9b243f8a439794e454bfb604061cb4a}\label{classov__core_1_1FeatureDatabase_ab9b243f8a439794e454bfb604061cb4a}} 
size\+\_\+t \hyperlink{classov__core_1_1FeatureDatabase_ab9b243f8a439794e454bfb604061cb4a}{size} ()
\begin{DoxyCompactList}\small\item\em Returns the size of the feature database. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_ad105b5cacc83eae1a5fb71f05b084294}\label{classov__core_1_1FeatureDatabase_ad105b5cacc83eae1a5fb71f05b084294}} 
std\+::unordered\+\_\+map$<$ size\+\_\+t, std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ \hyperlink{classov__core_1_1FeatureDatabase_ad105b5cacc83eae1a5fb71f05b084294}{get\+\_\+internal\+\_\+data} ()
\begin{DoxyCompactList}\small\item\em Returns the internal data (should not normally be used) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a890b5a9095ebe2a6adbe208865170274}\label{classov__core_1_1FeatureDatabase_a890b5a9095ebe2a6adbe208865170274}} 
double \hyperlink{classov__core_1_1FeatureDatabase_a890b5a9095ebe2a6adbe208865170274}{get\+\_\+oldest\+\_\+timestamp} ()
\begin{DoxyCompactList}\small\item\em Gets the oldest time in the database. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_ae4e973b1f5b56efd62ba08df987723bc}\label{classov__core_1_1FeatureDatabase_ae4e973b1f5b56efd62ba08df987723bc}} 
void \hyperlink{classov__core_1_1FeatureDatabase_ae4e973b1f5b56efd62ba08df987723bc}{append\+\_\+new\+\_\+measurements} (const std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1FeatureDatabase}{Feature\+Database} $>$ \&database)
\begin{DoxyCompactList}\small\item\em Will update the passed database with this database\textquotesingle{}s latest feature information. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_abf963d2ada2d2263d0b9668ab3bb03b0}\label{classov__core_1_1FeatureDatabase_abf963d2ada2d2263d0b9668ab3bb03b0}} 
std\+::mutex \hyperlink{classov__core_1_1FeatureDatabase_abf963d2ada2d2263d0b9668ab3bb03b0}{mtx}
\begin{DoxyCompactList}\small\item\em Mutex lock for our map. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a132a312f68e252936633bfaf4a1fc044}\label{classov__core_1_1FeatureDatabase_a132a312f68e252936633bfaf4a1fc044}} 
std\+::unordered\+\_\+map$<$ size\+\_\+t, std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ \hyperlink{classov__core_1_1FeatureDatabase_a132a312f68e252936633bfaf4a1fc044}{features\+\_\+idlookup}
\begin{DoxyCompactList}\small\item\em Our lookup array that allow use to query based on ID. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Database containing features we are currently tracking. 

Each visual tracker has this database in it and it contains all features that we are tracking. The trackers will insert information into this database when they get new measurements from doing tracking. A user would then query this database for features that can be used for update and remove them after they have been processed.



\begin{DoxyParagraph}{A Note on Multi-\/\+Threading Support}
There is some support for asynchronous multi-\/threaded access. Since each feature is a pointer just directly returning and using them is not thread safe. Thus, to be thread safe, use the \char`\"{}remove\char`\"{} flag for each function which will remove it from this feature database. This prevents the trackers from adding new measurements and editing the feature information. For example, if you are asynchronous tracking cameras and you chose to update the state, then remove all features you will use in update. The feature trackers will continue to add features while you update, whose measurements can be used in the next update step! 
\end{DoxyParagraph}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_abee9d8a5fa7fc4a97911058b6e8d10a0}\label{classov__core_1_1FeatureDatabase_abee9d8a5fa7fc4a97911058b6e8d10a0}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!cleanup@{cleanup}}
\index{cleanup@{cleanup}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{cleanup()}{cleanup()}}
{\footnotesize\ttfamily void Feature\+Database\+::cleanup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This function will delete all features that have been used up. 

If a feature was unable to be used, it will still remain since it will not have a delete flag set \mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a144b59272688f0aeea0ecec6028dca04}\label{classov__core_1_1FeatureDatabase_a144b59272688f0aeea0ecec6028dca04}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!features\+\_\+containing@{features\+\_\+containing}}
\index{features\+\_\+containing@{features\+\_\+containing}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{features\+\_\+containing()}{features\_containing()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ Feature\+Database\+::features\+\_\+containing (\begin{DoxyParamCaption}\item[{double}]{timestamp,  }\item[{bool}]{remove = {\ttfamily false},  }\item[{bool}]{skip\+\_\+deleted = {\ttfamily false} }\end{DoxyParamCaption})}



Get features that has measurements at the specified time. 

This function will return all features that have the specified time in them. This would be used to get all features that occurred at a specific clone/state. \mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a5cdb62171c42c8787daec984a8cebe15}\label{classov__core_1_1FeatureDatabase_a5cdb62171c42c8787daec984a8cebe15}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!features\+\_\+containing\+\_\+older@{features\+\_\+containing\+\_\+older}}
\index{features\+\_\+containing\+\_\+older@{features\+\_\+containing\+\_\+older}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{features\+\_\+containing\+\_\+older()}{features\_containing\_older()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ Feature\+Database\+::features\+\_\+containing\+\_\+older (\begin{DoxyParamCaption}\item[{double}]{timestamp,  }\item[{bool}]{remove = {\ttfamily false},  }\item[{bool}]{skip\+\_\+deleted = {\ttfamily false} }\end{DoxyParamCaption})}



Get features that has measurements older then the specified time. 

This will collect all features that have measurements occurring before the specified timestamp. For example, we would want to remove all features older then the last clone/state in our sliding window. \mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a4f6d8da846e81eac1faa3c7abd7f44a7}\label{classov__core_1_1FeatureDatabase_a4f6d8da846e81eac1faa3c7abd7f44a7}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!features\+\_\+not\+\_\+containing\+\_\+newer@{features\+\_\+not\+\_\+containing\+\_\+newer}}
\index{features\+\_\+not\+\_\+containing\+\_\+newer@{features\+\_\+not\+\_\+containing\+\_\+newer}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{features\+\_\+not\+\_\+containing\+\_\+newer()}{features\_not\_containing\_newer()}}
{\footnotesize\ttfamily std\+::vector$<$ std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ $>$ Feature\+Database\+::features\+\_\+not\+\_\+containing\+\_\+newer (\begin{DoxyParamCaption}\item[{double}]{timestamp,  }\item[{bool}]{remove = {\ttfamily false},  }\item[{bool}]{skip\+\_\+deleted = {\ttfamily false} }\end{DoxyParamCaption})}



Get features that do not have newer measurement then the specified time. 

This function will return all features that do not a measurement at a time greater than the specified time. For example this could be used to get features that have not been successfully tracked into the newest frame. All features returned will not have any measurements occurring at a time greater then the specified. \mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a3c7b5ef425c785eb3c160e995c545f87}\label{classov__core_1_1FeatureDatabase_a3c7b5ef425c785eb3c160e995c545f87}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!get\+\_\+feature@{get\+\_\+feature}}
\index{get\+\_\+feature@{get\+\_\+feature}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{get\+\_\+feature()}{get\_feature()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \hyperlink{classov__core_1_1Feature}{Feature} $>$ Feature\+Database\+::get\+\_\+feature (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{id,  }\item[{bool}]{remove = {\ttfamily false} }\end{DoxyParamCaption})}



Get a specified feature. 


\begin{DoxyParams}{Parameters}
{\em id} & What feature we want to get \\
\hline
{\em remove} & Set to true if you want to remove the feature from the database (you will need to handle the freeing of memory) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Either a feature object, or null if it is not in the database. 
\end{DoxyReturn}
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_a98e2d5320881107343b07f79cac8b541}\label{classov__core_1_1FeatureDatabase_a98e2d5320881107343b07f79cac8b541}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!get\+\_\+feature\+\_\+clone@{get\+\_\+feature\+\_\+clone}}
\index{get\+\_\+feature\+\_\+clone@{get\+\_\+feature\+\_\+clone}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{get\+\_\+feature\+\_\+clone()}{get\_feature\_clone()}}
{\footnotesize\ttfamily bool Feature\+Database\+::get\+\_\+feature\+\_\+clone (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{id,  }\item[{\hyperlink{classov__core_1_1Feature}{Feature} \&}]{feat }\end{DoxyParamCaption})}



Get a specified feature clone (pointer is thread safe) 


\begin{DoxyParams}{Parameters}
{\em id} & What feature we want to get \\
\hline
{\em feat} & \hyperlink{classov__core_1_1Feature}{Feature} with data in it \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
True if the feature was found 
\end{DoxyReturn}
\mbox{\Hypertarget{classov__core_1_1FeatureDatabase_adf78008573a5aebe8a89cddbaf4b5b01}\label{classov__core_1_1FeatureDatabase_adf78008573a5aebe8a89cddbaf4b5b01}} 
\index{ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}!update\+\_\+feature@{update\+\_\+feature}}
\index{update\+\_\+feature@{update\+\_\+feature}!ov\+\_\+core\+::\+Feature\+Database@{ov\+\_\+core\+::\+Feature\+Database}}
\subsubsection{\texorpdfstring{update\+\_\+feature()}{update\_feature()}}
{\footnotesize\ttfamily void Feature\+Database\+::update\+\_\+feature (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{id,  }\item[{double}]{timestamp,  }\item[{size\+\_\+t}]{cam\+\_\+id,  }\item[{float}]{u,  }\item[{float}]{v,  }\item[{float}]{u\+\_\+n,  }\item[{float}]{v\+\_\+n }\end{DoxyParamCaption})}



Update a feature object. 


\begin{DoxyParams}{Parameters}
{\em id} & ID of the feature we will update \\
\hline
{\em timestamp} & time that this measurement occured at \\
\hline
{\em cam\+\_\+id} & which camera this measurement was from \\
\hline
{\em u} & raw u coordinate \\
\hline
{\em v} & raw v coordinate \\
\hline
{\em u\+\_\+n} & undistorted/normalized u coordinate \\
\hline
{\em v\+\_\+n} & undistorted/normalized v coordinate\\
\hline
\end{DoxyParams}
This will update a given feature based on the passed ID it has. It will create a new feature, if it is an ID that we have not seen before. 